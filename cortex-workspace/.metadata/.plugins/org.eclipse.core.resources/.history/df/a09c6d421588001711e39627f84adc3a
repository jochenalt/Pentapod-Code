/*
 * BinaryCommandInterface.h
 *
 *  Created on: 14.08.2017
 *      Author: JochenAlt
 */

#ifndef I2CSLAVE_H_
#define I2CSLAVE_H_

#include "i2c_t3-v9.1.h"
#include "CortexComPackage.h"
class I2CPort {
public:
	I2CPort();
	virtual ~I2CPort();

	static I2CPort& getInstance();

	void setup(i2c_t3* wire);
	void loop();


	void executeRequest();

	void onBlockReceive(size_t howManyBytes);
	void onRequest();

private:
	i2c_t3* wire = NULL;

	static const unsigned int maxBufferSize = 512;
	uint8_t receiveBuffer[maxBufferSize];
	unsigned int receiveBufferLen;
	bool requestPending;
	bool responsePending;
	Cortex::RequestPackageData request;
	Cortex::ResponsePackageData response;

};

extern I2CPort i2cPort;

#endif /* I2CSLAVE_H_ */
